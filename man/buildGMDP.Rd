% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/buildGMDP.R
\name{buildGMDP}
\alias{buildGMDP}
\title{buildGMDP (Old Code style: peakTable + param=TRUE/FALSE)}
\usage{
buildGMDP(
  path,
  IDo = "00000000",
  engine = "openquake",
  vs30 = NULL,
  vref,
  quantile_AF = "mean",
<<<<<<< HEAD
<<<<<<< HEAD
  param = FALSE
=======
  POE_TARGET = NULL
>>>>>>> 3bae604 (clean)
=======
  POE_TARGET = NULL
>>>>>>> origin/v0.7.1
)
}
\arguments{
\item{path}{Path to hazard folder}

\item{IDo}{String ID to store in final tables}

\item{engine}{"openquake" or "user"}

\item{vs30}{Numeric vector or NULL => no site amp}

<<<<<<< HEAD
\item{vref}{Numeric reference Vs30 (760 or 3000)}

\item{quantile_AF}{e.g. "mean"}

\item{param}{logical. If TRUE => expansions, else meltdown}
=======
\item{vref}{Vs30 in m/s}

\item{quantile_AF}{character c("mean",0.16,0.50,0.84)}

\item{POE_TARGET}{numeric Target Probability of Exceedance}
<<<<<<< HEAD
>>>>>>> 3bae604 (clean)
=======
>>>>>>> origin/v0.7.1
}
\value{
list(AEPTable, UHSTable, AFmodel_AEP, AFmodel_UHS, SaTRmodel, RMwTable)
}
\description{
This function exactly follows your old code's minimal merges, creating a
"peak table" (\code{PeakUHS}) for the row at \code{Tn == Tn_PGA}, only
storing \code{(p, TR, PGA=Sa)}.  We then merge onto the main \code{UHSTable}
by \code{(p, TR)}.  We do not use \code{allow.cartesian=TRUE}, so no risk
of extra columns like \code{i.p}, \code{Tn.1}, etc.

Steps:
\enumerate{
\item Build \code{AEPTable} from OQ or user
\item If \code{engine="openquake"}, read disagg into \code{RMwTable}
\item If \code{param=TRUE}, do \code{(a,b,c)} expansions by \code{(p,Tn)}
=> \code{UHSTable}
\item If \code{param=FALSE}, read meltdown UHS from \code{importModel.oqUHS}
\item Create a \code{PeakUHS} with \code{(p,TR,PGA=Sa)} for \code{Tn==Tn_PGA},
merge onto main \code{UHSTable} by \code{(p,TR)}
\item Similarly build a peak table for \code{AEPTable} by \code{p},
merge to store \code{PGA}
\item Site amplification => group by \code{(p,Tn)} => merges with base R
\code{merge(...)} to multiply \code{Sa *= AF} and \code{PGA *= AF}.
\item Return final \code{AEPTable, UHSTable, AFmodel_AEP, AFmodel_UHS,
        SaTRmodel, RMwTable}.
}
}
